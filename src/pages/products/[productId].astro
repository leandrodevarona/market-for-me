---
export const prerender = true;

import Layout from "@layouts/Layout.astro";
import { getProducts, getProductById } from "@data/products";
import ProductImageViewer from "@components/markets/products/ProductImageViewer.astro";

export async function getStaticPaths() {
  const products = await getProducts();

  if (!products) return [];

  return products.map((product) => ({ params: { productId: product.id } }));
}

const { productId } = Astro.params;

const product = await getProductById(productId);

if (!product) return;
---

<Layout title={product.name}>
  <main class="product">
    <section>
      <ProductImageViewer imageUrls={product.imageUrls} />
    </section>
    <section class="product_info">
      <h1>{product.name}</h1>
      <hr />
      <span class="product_info__price">{product.price} {product.currency}</span
      >
      <p>{product.description}</p>
    </section>
  </main>
</Layout>

<style>
  .product {
    display: grid;
    grid-template-columns: 0.8fr 1fr;
    gap: 2rem;

    padding: 2rem;

    margin: 0 auto;
  }

  .product_info {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .product_info h1 {
    font-weight: 500;
  }

  .product_info hr {
    border-width: 1px;
  }

  .product_info__price {
    font-size: larger;
  }

  .product_info p {
    max-width: 600px;
    text-wrap: pretty;
  }

  /* Mobile */
  @media (max-width: 700px) {
    .product {
      grid-template-columns: none;
      grid-template-rows: 1fr 1fr;

      padding: 0.5rem;
    }
  }
</style>
